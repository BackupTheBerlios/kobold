\chapter{Tutorial}

\section{Getting started}

\subsection{Kobold Server}

To start the Kobold server within Eclipse just select 'Run...' in the
'Run' menu from
Eclipse and select the class
{\it kobold.server.SecureKoboldWebServer} with a numerical programm argument for
the port it should listen for connections. 
You've to enter only one VM argument which is needed to locate the {\it
server.properties} file and to suite your local requirements: \par

\begin{verbatim}
-Dkobold.server.configFile=/home/garbeam/eclipse/
kobold.server/server.properties
\end{verbatim}

Make sure that your {\it \$CLASSPATH} environment contains all JARs
provided by\\
 {\it kobold.common/contrib} beside a Java2 JRE and the Sun
JSSE classes (included by Sun JDK 1.4).

\subsection{Kobold Client Feature Set}
To start the Kobold client feature set from within Eclipse (which is
currently the only way) just select 'Run...' in the 'Run' menu and
double-click 'Run-time Workbench'. A new configuration is created which you 
can name as you wish (see \ref{run}). 

\begin{figure}[h!]
\begin{center}
\includegraphics[width=15cm]{run.png}
   \caption{The Run dialog}
\label{run}
\end{center}
\end{figure}\par

Confirm with 'Run'.

A new Eclipse instance will open with the Kobold feature set enabled.


\subsection{Kobold Server Administration Tool}
To start the Kobold Server Administration Tool within Eclipse just select 'Run...' in the
'Run' menu from
Eclipse and select the class
{\it kobold.client.serveradmin.ServerAdministrationTool}.

You've to enter only one VM argument which is needed to locate the {\it
sat.properties} file and to suite your local requirements: \par

\begin{verbatim}
-Dkobold.sat.configFile=/home/garbeam/eclipse/
kobold.client.serveradmin/sat.properties
\end{verbatim}

\section{Setting the Kobold preferences}
In the Kobold Client menu, select 'Window' and then 'Preferences'. The preferences
dialog opens (see \ref{pref}). Open the Kobold tree. In the SSL tab you can enter the 
properties for the Kobold Client. They resemble your SAT properties (see chapter 'Installation').
The VCM Configuration allows you to save your username, password and script for the
communication with the projects' repositories.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{pref.png}
   \caption{Kobold preferences}
\label{pref}
\end{center}
\end{figure}\par

\section{Product-related}

\subsection{Checking out a productline}

In the File menu select 'New' and then 'Kobold PLAM Project'. The Kobold wizard opens.
Enter the url of your Kobold server, your username and password. Then press
"test connection". If the test succeeds, the "next" button is enabled (see \ref{wizard1}).

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{wizard1.png}
   \caption{Kobold wizard}
\label{wizard1}
\end{center}
\end{figure}\par

After that you choose the productline you want to check out (see \ref{wizard2}).

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{wizard2.png}
   \caption{Kobold wizard}
\label{wizard2}
\end{center}
\end{figure}\par

In the last step you have to enter the name of the project you want to create (see \ref{wizard3}).

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{wizard3.png}
   \caption{Kobold wizard}
\label{wizard3}
\end{center}
\end{figure}\par

A new project has been created. You can open the different views through the Window menu
and 'show view'. 

\subsection{Creating a product}

In the palette press 'compose product'. The components, etc. in the architecture view turn
grey. You can now select the components, variants and releases you want to include into
you new product. The chosen objects turn blue (see \ref{compose}). When done press the 
'create product' button in the Architecture Editor. A dialog opens where you can enter
the name and metainfo of your new product. After confirming the dialog, you can see
your new product in the Role View.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{composeproduct.png}
   \caption{Composing a Product}
\label{compose}
\end{center}
\end{figure}\par


%\subsection{Renaming a product}

%Right-click on the product and choose "rename product" in the context menu. You can
%now enter a new name which will be used in the repository and the product line tree.

%TODO: Screenshot einfügen

%\subsection{Changing a product}

%Right-click on the product and choose "change product". A wizard opens where you can
%change the CoreAssets for your product. 

%TODO: Screenshot einfügen

%After you press "proceed", you are able
%to choose modules of other products from this product line. Press "Finish" and the changes
%are saved.

%\subsection{Setting a product on deprecated}

%Right-click on the product and choose "set on deprecated". Confirm your choice in
%the upcoming dialog and the product is deprecated. Its modules can no longer be
%used in a product.

%TODO: Screenshot einfügen


\section{Node-related}

%\subsection{Creating a Core Asset}

%In the pallete select the "core asset" tool. Click into the Architecture Editor and
%a core asset is inserted. A dialog opens where you can enter the meta data of
%the core asset. Per drag+drop you can simply change the size of the core
%asset. \par
%Note: Core assets can only be inserted on the top-level plane of the Architecture Editor.

%TODO: Screenshot einfügen


\subsection{Creating a component}

In the pallete select the "component" tool. Click within a variant or top-level in 
the Architecture Editor. A component is inserted (see \ref{component}) and a dialog opens where you can enter the meta data of
the component. Per drag+drop you can simply change the size of the component. \par
Note: Components can only be inserted top-level or into variants.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=8cm]{component.png}
   \caption{Component}
\label{component}
\end{center}
\end{figure}\par


\subsection{Creating a variant}

In the pallete select the "variant" tool. Click within a component in 
the Architecture Editor. A variant is inserted (see \ref{variant}) and a dialog opens where you can enter the meta data of
the variant. Per drag+drop you can simply change the size of the variant. \par
Note: Variants can only be inserted into components.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{variant.png}
   \caption{Variant}
\label{variant}
\end{center}
\end{figure}\par


\subsection{Creating a release}

In the pallete select the "release" tool. Click within a variant in 
the Architecture Editor. A release is inserted (see \ref{release}) and a dialog opens where you can enter the meta data of
the release. For each file of the variant you can select the revision number you want to add to the release. 
Per drag+drop you can simply change the size of the release. \par
Note: Releases can only be inserted into variants.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{release.png}
   \caption{Release}
\label{release}
\end{center}
\end{figure}\par

\subsection{Creating a meta node}

In the pallete select the "meta node" tool. Click within the Architecture Editor. 
A meta node is inserted (see \ref{meta}). Possible meta node types are AND and OR. Be careful with
the direction of the edges that are linked to a meta node! In the following architecture component A
needs components B and C. But components B and C are independent of component A (see \ref{example}).

\begin{figure}[h!]
\begin{center}
\includegraphics[width=4cm]{metanode.png}
   \caption{Some meta nodes}
\label{meta}
\end{center}
\end{figure}\par

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{example.png}
   \caption{Meta node example}
\label{example}
\end{center}
\end{figure}\par

\subsection{Deleting a component, variant or release}

Right-click on the item you want to delete and choose "delete" in the context
menu. Alternatively you
can select the item and press "Del" on your keyboard. Is the item used in other projects
you will be notified and be able to cancel the deletion process.

\subsection{Deleting a meta node}

Right-click on the meta node you want to delete and choose "delete" in the context
menu. Alternatively you
can select the node and press "Del" on your keyboard.

\subsection{Marking a component, variant or release as "deprecated"}
Right-click on the object and choose "configure". The Asset Configuration dialog (see \ref{config} and \ref{config2}) opens where you can
mark the check-box 'deprecated'. This sets the object on deprecated. Deprecated objects are grey with a 
red cross in the upper right-hand corner (see \ref{deprecated}).

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{config.png}
   \caption{Asset Configuration dialog (component)}
\label{config}
\end{center}
\end{figure}\par

\begin{figure}[h!]
\begin{center}
\includegraphics[width=7cm]{deprecated.png}
   \caption{Deprecated component}
\label{deprecated}
\end{center}
\end{figure}\par

\subsection{Setting the maintainers of a component}
Right-click on the component and choose "configure". The Asset Configuration dialog (see \ref{config}) opens.
Press the 'Edit...' button. A new window opens where you can select the users you want to make maintainers of
the component (see \ref{maintainer}). After pressing 'OK' you can see the new maintainers in the Asset Configuration
dialog.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{maintainer.png}
   \caption{Selecting maintainers}
\label{maintainer}
\end{center}
\end{figure}\par

\subsection{Selecting resources for a release}
Right-click on the component and choose "configure". The Asset Configuration dialog (see \ref{config2}) opens.
In the bottom of the dialog you can select the files of the variant you want to include into the release.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{config2.png}
   \caption{Asset Configuration dialog (release)}
\label{config2}
\end{center}
\end{figure}\par

\subsection{Moving an item}
You can move any item per drag+drop.

\subsection{Changing the size of an item}
You can change the size of an item per drag+drop.

%\subsection{Creating a custom component}

%In the pallete select the "custom component" tool. Click into the Architecture 
%Editor. A component is inserted. A dialog opens where you can enter the meta data of
%the component. Per drag+drop you can simply change the size of the component. \par

%TODO: Screenshot einfügen

%\subsection{Deleting a custom component}

%Right-click on the component you want to delete and choose "delete" in the context
%menu. Alternatively you
%can select the component and press "Del" on your keyboard. 


%\subsection{Setting a module on deprecated}

%Right-click on the module and choose "set on deprecated". Confirm your choice in
%the upcoming dialog and the module is deprecated. It can no longer be
%used in a product.

%TODO: Screenshot einfügen



\section{Edge-related}

\subsection{Creating a dependency edge}

In the pallete select the "include edge" tool. Select an item in the Architecture Editor
as the starting point. The next item you select will be the aiming point (see \ref{include}).

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{include.png}
   \caption{Dependency edge}
\label{include}
\end{center}
\end{figure}\par

\subsection{Creating an exclusion edge}

In the pallete select the "exclude edge" tool. Select an item in the Architecture Editor
as the starting point. The next item you select will be the aiming point (see \ref{exclude}).

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{exclude.png}
   \caption{Exclusion edge}
\label{exclude}
\end{center}
\end{figure}\par

\subsection{Deleting an edge}

Right-click on the edge you want to delete and choose "delete" in the context menu.
Alternatively you can select the edge and press "Del" on your keyboard.


\section{Message-related}

\subsection{Writing a mail}

In the menu of the Workflow View select "new mail". A Workflow window opens where
you can enter your message, the subject and the recipient of the message. Send the
message by pressing the "Send" button. Pressing the "Cancel" button will close the window
without sending your message (see \ref{writemail}).

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{writemail.png}
   \caption{Write a new mail}
\label{writemail}
\end{center}
\end{figure}\par

\subsection{Answering a mail}

In the Workflow View double-click on the mail you want to answer. A Workflow
window opens where you can see the message text of the mail. Below you can enter
the subject and the text of your reply. Send the answer by pressing the "Send" 
button. Pressing the "Cancel" button will close the window without sending 
your message (see \ref{answermail}).

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{answermail.png}
   \caption{Answer a mail}
\label{answermail}
\end{center}
\end{figure}\par

\subsection{Deleting a message}

Right-click on the message and choose "Delete message" in the context menu.

\subsection {Fetching messages}

Select a project. Right-click in the Workflow View or open the corresponding menu. Choose "Fetch message".
Your new messages are being fetched and displayed in the Workflow View.

%\subsection {Filtering the Workflow View}

%(still undefined)

\subsection{Suggesting an asset for a Core Group}

There are two way to suggest an asset for a Core Group.

In the menu of the Workflow View select 'Suggest asset for core group'. A dialog opens where
 you can select the type of recipient, i.d. whether the suggestion is to be sent to a PE or a PLE. After
 that decision a Workflow
window opens where you can enter the name of the asset and the username of the
PE/PLE you want to send the message to. You can also enter an additional comment you want 
the PE/PLE to read. Send the message by pressing the "Send" 
button. Pressing the "Cancel" button will close the window without sending 
your message (see \ref{core1}).

In the Role View, select the asset you want to suggest and right-click on it. The context menu opens where
 you choose the option 'Suggest asset for core group'. A dialog opens where
 you can select the type of recipient, i.d. whether the suggestion is to be sent to a PE or a PLE. After
 that decision a Workflow
window opens where you can enter the name of the asset and the username of the
PE/PLE you want to send the message to. You can also enter an additional comment you want 
the PE/PLE to read. Send the message by pressing the "Send" 
button. Pressing the "Cancel" button will close the window without sending 
your message (see \ref{core1}).

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{core1.png}
   \caption{Suggesting a file for a Core Group}
\label{core1}
\end{center}
\end{figure}\par

\subsection{Dealing with a Core Group suggestion}

In the Workflow View double-click on the Core Group suggestion message. A Workflow
window opens where you can see the message of the programmer (see \ref{core2}) or PE (see \ref{core3}). Below you
can select whether you agree to the suggestion or whether you decline it. You can also
enter an additional comment if you like. Send the message by pressing the "Send" 
button. Pressing the "Cancel" button will close the window without sending 
your message.\par
Note: The file will not be automatically uploaded and committed. The PLE has to do
this manually.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{core2.png}
   \caption{Dealing with a Core Group suggestion - PE}
\label{core2}
\end{center}
\end{figure}\par

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{core3.png}
   \caption{Dealing with a Core Group suggestion - PLE}
\label{core3}
\end{center}
\end{figure}\par

\section{Exporting through GXL}

Select the productline, product, component or variant you want to export. In the
context menu of the object select "export" (see \ref{archcontext}). A wizard opens (see \ref{export}) where you can enter
the path and name of the gxl-file. Alternatively you can enter 
the data through the "browse" dialog. To start the export, press the OK button.
You are able to see the status of your export in the wizard which will close after
the export is finished. If you decide not to do the export, simply press the 
"cancel" button.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{architecturekontext.png}
   \caption{Context menu of the Architecture View}
\label{archcontext}
\end{center}
\end{figure}\par

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{export.png}
   \caption{Export wizard}
\label{export}
\end{center}
\end{figure}\par


\section{Creating a Workflow}

Workflows are triggered by specific rules which you can find in the ruleset.drl file.
Here you can find some existing rules as an example. \par

A rule consists of the following parts:
\begin{itemize}
	\item name
	\item parameters
	\item conditions
	\item one consequence
\end{itemize}
Rules are a mixture of XML and Java.\par

This is what a sample rule looks like: \\

$<$rule name = "Name of the rule"$>$\\
\begin{quote}
$<$parameter identifier = "spy"$>$\\
\begin{quote}
$<$java:class$>$ kobold.common.data.RPCSpy $<$/java:class$>$\\
\end{quote}
$<$/parameter$>$\par
$<$java:condition$>$ spy.getMethodName().equals("login") $<$/java:condition$>$\par
$<$java:consequence$>$ System.out.println("Rule fired."); $<$/java:consequence$>$\\
\end{quote}
$<$/rule$>$\par


The rule will only be fired when its conditions are true. If there are several conditions,
all of them have to be true. Conditions and consequence are written in Java.\par

For your own rules, the rule's parameter will always be an RPCSpy object of the package
kobold.common.data. Such an object is created whenever an action is being executed by the server.
These are in detail (using their actual method names):
\begin{itemize}
	\item addUser
	\item getAllUsers
	\item removeUser
	\item updateUserPassword
	\item updateUserFullName
	\item getProductlineNames
	\item getProductline
	\item updateProductline
	\item updateProduct
	\item updateComponent
\end{itemize}
The parameter RPCSpy will contain the methodName which you can get with the "getMethodName()" method. 
This returns one of the above Strings. An RPCSpy object also contains a vector of
arguments that were transmitted to the server for the execution. You have access to this vector through
the "getArguments()" method. \par
The ruleset.drl file contains a sample rule for adding a user. Whenever a new user is added, every other user
is notified. \par
In the last chapter you find the source code of the classes you need to work with for writing your own rules.
In order to have an up-to-date appendix, check out the complete Kobold module. 
Then enter the following command in the console within the directory of the user manual:

\begin{verbatim}
perl appendix.pl >appendix.tex
\end{verbatim}

After that, rebuild the usermanual.pdf.

%\section{Filtering the Architecture View}

%The toolbar of the Architecture Editor provides you with the following filterings:
%\begin{itemize}
%	\item Show/hide dependency edges
%	\item Show/hide exclusion edges
%	\item Show/hide synthetical edges
%	\item Show/hide deprecated components
%\end{itemize}

%TODO: Screenshot einfügen

\section{Generating a metainfo document}
In the role tree right-click on the object (productline, product, component, variant, release) you want the metainfo document about
and select 'generate document...'. A 'Save as' dialog opens where you can select the parent folder into which the pdf-file
will be saved. Confirm by pressing the 'OK' button and the pdf-file is created.

\section{Configuring an asset}
In the role tree right-click on the object (productline, product, component, variant, release) you want to configure
and select 'configure asset...'. The corresponding 'Asset Configuration' dialog opens where you can make your
changes (see \ref{config} and \ref{config2}).


\section{User-related}

\subsection{Creating a user}

Right-click in the role tree. In the context menu choose
'create new user'. The User Manager (see \ref{createuser1}) opens where you see a list of all existing users.
Push the 'create new user' button. In the opening dialog you can enter the username, real name and the
initial password of the user (see \ref{createuser2}). Pressing the 'OK' button creates the new user and you
can see the new user in the list of the User Manager.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{createuser1.png}
   \caption{Create a new user - step 1}
\label{createuser1}
\end{center}
\end{figure}\par

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{createuser2.png}
   \caption{Create a new user - step 2}
\label{createuser2}
\end{center}
\end{figure}\par

%\subsection{Changing a user role}

%Right-click on the corresponding product and choose "change role". A wizard opens.
%On the left side you can see a list of all existing users. On 
%the right side you can see lists of the product engineers and programmers that
%belong to the product. You can switch users from left to right and back by selecting
%the user and using
%the "<<" and ">>" buttons between the lists. In order to find a specific user in
%the left-hand list, enter the initial letters of the user. The list will then show
%only those usernames that start with the same letters. Press "Ok" when you are done
%and your changes are saved.

%TODO: Screenshot einfügen

\subsection{Deleting a user}

Right-click in the role tree and select 'remove user'. A dialog opens with a list of all 
existing users (see \ref{delete}). Simply select the check-box next to the user you want to delete and confirm
with 'OK'. The user has been deleted.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{delete.png}
   \caption{Remove a user}
\label{delete}
\end{center}
\end{figure}\par

\subsection{Changing ones password}

Right-click in the role tree and select 'change password'. A dialog opens where you can
enter your new password (see \ref{password}). Confirm the password and press 'OK'. Your password has been changed.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{password.png}
   \caption{Change your password}
\label{password}
\end{center}
\end{figure}\par

\subsection{Updating ones full name}
Right-click in the role tree and select 'update full name'. A dialog opens where you can
enter your new full name (see \ref{fullname}). Confirm the changes with your password and press 'OK'. Your full name has been changed.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=10cm]{updatefullname.png}
   \caption{Update your full name}
\label{fullname}
\end{center}
\end{figure}\par

\section{SAT-related}

\subsection{Creating a product line}
Enter the command 'newpl'. You are asked to enter the name of the new product
line and its meta data. Once you confirmed your entry, the product line is created.

\subsection{Deleting a product line}
Enter the command 'rempl'. You are then asked to enter the name of the product
line you want to remove. Once you confirmed your entry, the product line is deleted.

\subsection{Upgrading an existing user to PLE status}
Enter the command 'assignple'. You are asked to enter the name of the person you want
to upgrade as PLE. Finally, enter the name of the product line you want to assign
the new PLE to. Once you confirmed your entry, the user has PLE rights.

\subsection{Removing PLE rights}
Enter the command 'unassignple'. You are asked to enter the name of the user who shall 
no longer have PLE rights. Also, enter the name of the product line you want to
remove the PLE from. Once you confirmed your entry, the user is no longer PLE of
the entered product line.

\subsection{Getting a list of all existing commands}
Enter the command 'help' and you get a list of all the commands of this tool and
their meanings.

\subsection{Getting information about SAT's version and licence}
Enter the command 'about' and you get information about the programm's version and licence.

\subsection{Changing the URL}
Enter the command 'seturl'. Enter a new url to change the current url.

\subsection{Changing the password}
Enter the command 'setpasswd' and then a new password in order to change the password that is used to access
the current server.

\subsection{Creating a new user}
Enter the command 'newuser'. Enter the name, username and password of the new user and confirm.

\subsection{Deleting a user}
Enter the command 'remuser'. Enter the username of the user in order to remove him/her from the server.

\subsection{Getting a list of all productlines}
Enter the command 'pllist' in order to get a list of all existing productlines.

\subsection{Getting a list of all ples of a productline}
Enter the command 'plelist' and then the name of the productline in order to get a list
 of the assigned ples.
 
\subsection{Getting a list of all registered users}
Enter the command 'userlist' in order to get a list of all existing users.

\subsection{Exiting the tool}
Enter the command "exit".