\subsubsection{Drools}

Kobold bietet seinem Benutzer einen Workflow-Mechanismus, der die Wahrung des 
definierten produktlinien-basierten Entwicklungsprozesses unterstützt. Dieser 
führt Konsistenzprüfungen durch, die in anderen Client-Instanzen automatisch 
Workflows  anstoßen, um die Inkonsistenz zu beheben. Zur Realisierung des 
Workflow-Mechanismus wird die Rule Engine Drools\footnote{http://www.drools.org} 
verwendet.\par
Dafür wird eine Regelbasis in XML für Drools erzeugt. Diese besteht aus einer 
Menge aller Regelmengen und befindet sich auf dem Server. Eine Regelmenge 
wiederum besteht aus Regeln. Eine solche Regel gliedert sich in drei Teile: 
Parameter, Bedingung und Konsequenz. Dabei bilden die Parameter eventuell benötigte 
Parameter für die Regel. Die Bedingung überprüft, ob die Regel angewendet wird 
oder nicht. Die Konsequenz beeinhaltet die Aktionen, die durchgeführt werden, 
falls die Bedingung erfüllt ist.\par

Der Workflow-Mechanismus spielt sich sowohl auf dem Kobold Server als auch auf 
dem Kobold Client ab.\par

\paragraph{Aktionen auf dem Kobold Server}
Führt ein Client eine Aktion aus, so wird diese dem Kobold Server gemeldet. 
Dieser wendet die Aktion als Fakt auf die Regelbasis an, die sich auf dem Server 
befindet. Ein Fakt ist dabei eine Mitteilung an den Server. Es werden dabei 
alle Regeln durchlaufen. Stimmt das Ereignis mit der Bedingung einer Regel 
überein, so wird die Konsequenz dieser ausgeführt. Die Ergebnisse dieser 
Regelkonsequenzen werden zu einem Workflow-Objekt zusammengefügt (zum Beispiel 
eine Reihe von Anweisungen). Ein Workflow-Objekt ist dabei eine Art XML-Struktur, 
die einen Titel und eine Liste aller Regelresultate besitzt. Diese Workflow-Objekt 
wird dann auf die Message-Queues der Clients gelegt, für die das Workflow-Objekt 
relevant ist. 

\paragraph{Aktionen auf dem Kobold Client}
Sobald der Client eine Aktion ausführt, meldet er diese dem Kobold Server um 
mögliche Inkonsistenzen zu vermeiden. Wird ein Workflow entwickelt, so ruft 
jeder Kobold Client, der den Workflow anstoßen sollte, beim nächsten Login 
dieses Objekt ab. Der Anwender wird darüber in der Workflow-View des Kobold 
Clients informiert.\newline
\newline
\includegraphics[width=15cm]{drools.png}\newline

\paragraph{Die Regelbasis in Kobold}
Kobold wird in dieser Iteration eine Anfangsregelbasis zur Verfügung stellen, 
die vom Anwender jederzeit erweitert werden kann. Er muss dabei eine neue 
Regel erstellen und sie der Regelbasis hinzufügen. Diese Regeln müssen dann 
nicht unbedingt zum Workflow-Objekt hinzugefügt werden, sondern können in 
ihrer Konsequenz auch andere Aktionen ausführen. 
Dies bleibt dem Anwender überlassen. Zur Erstellung einer neuen Regel wird 
ihm außerdem ein Editor zur Verfügung stehen, der in einer der kommenden 
Iterationen entstehen wird. 